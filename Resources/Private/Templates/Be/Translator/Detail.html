<html
        xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
        xmlns:core="http://typo3.org/ns/TYPO3/CMS/Core/ViewHelpers"
        xmlns:be="http://typo3.org/ns/TYPO3/CMS/Backend/ViewHelpers"
        data-namespace-typo3-fluid="true">

<f:layout name="Default" />

<f:section name="headline">
</f:section>

<f:section name="content">
    <div class="hd-translator">
        <f:if condition="{is_empty}">
            <f:then>
                This language is not set
            </f:then>
            <f:else>
                <f:if condition="{data}">
                    <div>
                        <button><f:translate key="detail.download" /></button>
                        <div class="download-links">
                            <div>
                                <f:link.action absolute="1" class="download-link" action="download" arguments="{keyTranslation: translationKey, languageTranslation: langaugeKey, format: 'xlf'}">xlf</f:link.action>
                            </div>
                            <div>
                                <f:link.action absolute="1" class="download-link" action="download" arguments="{keyTranslation: translationKey, languageTranslation: langaugeKey, format: 'xls'}">xls</f:link.action>
                            </div>
                            <div>
                                <f:link.action absolute="1" class="download-link" action="download" arguments="{keyTranslation: translationKey, languageTranslation: langaugeKey, format: 'csv'}">csv</f:link.action>
                            </div>
                            <div>
                                <f:link.action absolute="1" class="download-link" action="download" arguments="{keyTranslation: translationKey, languageTranslation: langaugeKey, format: 'json'}">json</f:link.action>
                            </div>
                        </div>
                    </div>
                    <f:form action="save" id="translation-form" objectName="data" arguments="{keyTranslation: translationKey, languageTranslation: langaugeKey}" method="post" name="data">
                        <div class="hd-translator-detail-grid">
                            <f:for each="{data.{langaugeKey}}" key="key" as="value">
                                <div class="hd-translator-detail-grid-item">
                                    <div class="hd-translator-key">{key}</div>
                                    <div class="hd-translator-field"><f:form.textfield name="data[{key}][{langaugeKey}]" type="text" placeholder="{key}" value="{value.0.target}" /></div>
                                    <div class="hd-translator-original">{value.0.source}</div>
                                    <f:if condition="{langaugeKey} != 'default'">
                                        <div style="display: none">
                                            <f:form.hidden name="data[{key}][default]" value="{value.0.source}" />
                                        </div>
                                    </f:if>
                                </div>
                            </f:for>
                        </div>
                    </f:form>
                </f:if>
            </f:else>
        </f:if>
    </div>

    <script>
        let save = document.querySelector('a[data-action=save]')
        if (save){
            save.addEventListener('click', (event) => {
                document.getElementById('translation-form').submit();
            })
        }
    </script>
</f:section>
</html>